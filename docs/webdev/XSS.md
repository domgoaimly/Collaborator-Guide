# Cross-Site Scripting 

Cross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. 
XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end 
user. Flaws that allow these attacks to succeed are quite widespread and occur anywhere a web application uses input from a user within the output 
it generates without validating or encoding it.

An attacker can use XSS to send a malicious script to an unsuspecting user. The end user’s browser has no way to know that the script should not be 
trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session 
tokens, or other sensitive information retained by the browser and used with that site.

Cross-Site Scripting (XSS) attacks occur when:

- Data enters a Web application through an untrusted source, most frequently a web request.
- The data is included in dynamic content that is sent to a web user without being validated for malicious content.

The malicious content sent to the web browser often takes the form of a segment of JavaScript, but may also include HTML, Flash, or any other 
type of code that the browser may execute. The variety of attacks based on XSS is almost limitless, but they commonly include transmitting private 
data, like cookies or other session information, to the attacker, redirecting the victim to web content controlled by the attacker, or performing 
other malicious operations on the user’s machine under the guise of the vulnerable site.

## XSS Attack Consequences

The consequence of an XSS attack is the same regardless of whether it is stored, reflected, or DOM Based. The difference is in how the payload 
arrives at the server. Do not be fooled into thinking that a “read-only” or “brochureware” site is not vulnerable to serious reflected XSS attacks. 
XSS can cause a variety of problems for the end user that range in severity from an annoyance to complete account compromise. The most severe XSS 
attacks involve disclosure of the user’s session cookie, allowing an attacker to hijack the user’s session and take over the account. Other damaging 
attacks include the disclosure of end user files, installation of Trojan horse programs, redirecting the user to some other page or site, or 
modifying presentation of content. An XSS vulnerability allowing an attacker to modify a press release or news item could affect a company’s stock 
price or lessen consumer confidence. An XSS vulnerability on a pharmaceutical site could allow an attacker to modify dosage information resulting in 
an overdose.

Content spoofing, also referred to as content injection, “arbitrary text injection” or virtual defacement, is an attack targeting a user made 
possible by an injection vulnerability in a web application. When an application does not properly handle user-supplied data, an attacker can 
supply content to a web application, typically via a parameter value, that is reflected back to the user. This presents the user with a modified 
page under the context of the trusted domain. This attack is typically used as, or in conjunction with, social engineering because the attack is 
exploiting a code-based vulnerability and a user’s trust. As a side note, this attack is widely misunderstood as a kind of bug that brings no impact.

Attack Type: Client-Side

## Risk Factors

Risk factors depend on the business type of the application. If the application business brand is well known and has major competitors, 
this issue can be abused by malicious competitors/disgruntled employees/unsatisfied customers to trigger mass distributions of false messages 
to unsuspecting customers. Another factor that heightens the risk is by doing SEO injection in a way that search engines crawl and index crafted 
URLs with falsified messages.

By doing so, customers could be forced to switch to competitor’s products. This could lead to loss of monetary value until rectification is properly 
done by the victim business. For public traded companies, its shares will be falling down, leading to uncontrolled loss of millions.

## Audit Guideline

Text injection can be easily found if:

- User input via parameter or directly in the URL is reflected in the page response
- Content-Type: text/plain
- Application is giving default error pages

## Server XSS

Server XSS occurs when untrusted user supplied data is included in an HTTP response generated by the server. The source of this data could be from 
the request, or from a stored location. As such, you can have both Reflected Server XSS and Stored Server XSS.

In this case, the entire vulnerability is in server-side code, and the browser is simply rendering the response and executing any valid script 
embedded in it.

Server XSS is caused by including untrusted data in an HTML response. The easiest and strongest defense against Server XSS in most cases is:

- Context-sensitive server side output encoding
The details on how to implement Context-sensitive server side output encoding are presented in the OWASP XSS (Cross Site Scripting) Prevention Cheat 
Sheet in great detail.

Input validation or data sanitization can also be performed to help prevent Server XSS, but it’s much more difficult to get correct than context-sensitive 
output encoding.

## Stored XSS 

Stored XSS generally occurs when user input is stored on the target server, such as in a database, in a message forum, visitor log, comment field, etc. 
And then a victim is able to retrieve the stored data from the web application without that data being made safe to render in the browser. 
With the advent of HTML5, and other browser technologies, we can envision the attack payload being permanently stored in the victim’s browser, 
such as an HTML5 database, and never being sent to the server at all.

## Reference

- https://owasp.org/www-community/Types_of_Cross-Site_Scripting
- https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html
